#!/bin/sh

# production proxibase startup script using nodemon
# see https://github.com/remy/nodemon
# Useage: 
#   cd <proxdir>
#   sudo bin/proxstart

if [ ! $PROX ]; then
  PROX='/usr/local/prox'
fi

if [ ! $PROXLOG ]; then
  PROXLOG='/var/log/prox/prox.log'
fi

# clean the existing log
if [ "$1" = "-c" ]; then
  rm $PROXLOG
fi

echo "proxlog: $PROXLOG"

cd $PROX
nohup nodemon --watch lib --delay 1 prox.js >>$PROXLOG 2>&1 &

sleep 2
cat $PROXLOG
echo
